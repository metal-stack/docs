<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Global Network View · metal-stack</title><meta name="title" content="Global Network View · metal-stack"/><meta property="og:title" content="Global Network View · metal-stack"/><meta property="twitter:title" content="Global Network View · metal-stack"/><meta name="description" content="Documentation for metal-stack."/><meta property="og:description" content="Documentation for metal-stack."/><meta property="twitter:description" content="Documentation for metal-stack."/><meta property="og:url" content="https://docs.metal-stack.io/developers/proposals/MEP17/README/"/><meta property="twitter:url" content="https://docs.metal-stack.io/developers/proposals/MEP17/README/"/><link rel="canonical" href="https://docs.metal-stack.io/developers/proposals/MEP17/README/"/><script data-outdated-warner src="../../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../search_index.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script><link href="../../../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../../../assets/youtube.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../"><img src="../../../../assets/logo.svg" alt="metal-stack logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../../">metal-stack</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><span class="tocitem">General</span><ul><li><a class="tocitem" href="../../../../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../../../../concepts/why-metal-stack/">Why metal-stack</a></li><li><a class="tocitem" href="../../../../concepts/why-bare-metal/">Why Bare Metal</a></li><li><a class="tocitem" href="../../../../general/flavors-of-metal-stack/">Flavors of metal-stack</a></li></ul></li><li><span class="tocitem">For Users</span><ul><li><a class="tocitem" href="../../../../users/client-libraries/">Client Libraries</a></li></ul></li><li><span class="tocitem">For Operators</span><ul><li><a class="tocitem" href="../../../../operators/hardware/">Supported Hardware</a></li><li><a class="tocitem" href="../../../../operators/operating-systems/">Operating Systems</a></li><li><a class="tocitem" href="../../../../operators/deployment-guide/">Deployment Guide</a></li><li><a class="tocitem" href="../../../../operators/maintenance/">Maintenance</a></li><li><a class="tocitem" href="../../../../operators/troubleshoot/">Troubleshoot</a></li></ul></li><li><span class="tocitem">Concepts</span><ul><li><a class="tocitem" href="../../../../concepts/architecture/">Architecture</a></li><li><a class="tocitem" href="../../../../concepts/user-management/">User Management</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Network</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../concepts/network/theory/">Theory</a></li><li><a class="tocitem" href="../../../../concepts/network/firewalls/">Firewalls</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-4" type="checkbox"/><label class="tocitem" for="menuitem-5-4"><span class="docs-label">Kubernetes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../concepts/kubernetes/gardener/">Gardener</a></li><li><a class="tocitem" href="../../../../concepts/kubernetes/cluster-api/">Cluster API</a></li><li><a class="tocitem" href="../../../../concepts/kubernetes/cloud-controller-manager/">Cloud Controller Manager</a></li><li><a class="tocitem" href="../../../../concepts/kubernetes/firewall-controller-manager/">Firewall Controller Manager</a></li><li><a class="tocitem" href="../../../../concepts/kubernetes/isolated-clusters/">Isolated Cluster</a></li><li><a class="tocitem" href="../../../../concepts/kubernetes/gpu-workers/">GPU Workers</a></li><li><a class="tocitem" href="../../../../concepts/kubernetes/storage/">Storage</a></li></ul></li></ul></li><li><span class="tocitem">For CISOs</span><ul><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Security</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../cisos/security/principles/">Security Principles</a></li><li><a class="tocitem" href="../../../../cisos/security/sbom/">SBOM</a></li><li><a class="tocitem" href="../../../../cisos/security/cryptography/">Cryptography</a></li><li><a class="tocitem" href="../../../../cisos/security/communication-matrix/">Communication Matrix</a></li></ul></li></ul></li><li><span class="tocitem">For Developers</span><ul><li><a class="tocitem" href="../../">Enhancement Proposals</a></li><li><a class="tocitem" href="../../../planning-meetings/">Planning Meetings</a></li><li><a class="tocitem" href="../../../contribution-guideline/">Contribution Guideline</a></li><li><a class="tocitem" href="../../../release-flow/">Release Flow</a></li><li><a class="tocitem" href="../../../community/">Community</a></li></ul></li><li><span class="tocitem">References</span><ul><li><a class="tocitem" href="../../../../references/apidocs/">API</a></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Components</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../references/external/mini-lab/README/">mini-lab</a></li><li><a class="tocitem" href="../../../../references/external/metalctl/README/">metalctl</a></li><li><a class="tocitem" href="../../../../references/external/csi-driver-lvm/README/">csi-driver-lvm</a></li><li><a class="tocitem" href="../../../../references/external/firewall-controller/README/">firewall-controller</a></li><li><a class="tocitem" href="../../../../references/external/tailscale/README/">tailscale</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Global Network View</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Global Network View</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/metal-stack/docs.git" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="github.com/metal-stack/docs.git" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Global-Network-View"><a class="docs-heading-anchor" href="#Global-Network-View">Global Network View</a><a id="Global-Network-View-1"></a><a class="docs-heading-anchor-permalink" href="#Global-Network-View" title="Permalink"></a></h1><blockquote><p>[!IMPORTANT]   This MEP assumes the implementation of the metal-apiserver as described by <a href="../../MEP4/README/">MEP-4</a> which is currently work in progress.</p></blockquote><p>Having a complete view of the network topology is useful when working with deployments or troubleshooting connectivity issues. Currently, the API doesn&#39;t know of any other switches than the leaf switches. Information about all other switches and their connections must be gathered from Ansible inventories or by accessing the switches via SSH. Documentation of each partition&#39;s network must be kept in-sync with all changes made to the deployment or cabling. We would like to expand the API&#39;s knowledge of the network to the entire underlay including inter-switch connections as well as BGP statistics and health status.</p><h2 id="Switch-Types"><a class="docs-heading-anchor" href="#Switch-Types">Switch Types</a><a id="Switch-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Switch-Types" title="Permalink"></a></h2><p>Registering a switch at the API is done by the metal-core. Apart from that, it also reconciles port and FRR configuration to adapt to the machine provisioning cycle. This reconfiguration is only necessary on the leaf switches. To allow deploying the metal-core on other switches than leaves we need a way of telling it what type of switch it is running on so it can act accordingly. On any non-leaf switches it will only register the switch and report statistic but not change any configuration. Supported switch types are</p><ul><li><code>leaf</code></li><li><code>spine</code></li><li><code>exit</code></li><li><code>mgmtleaf</code></li><li><code>mgmtspine</code></li></ul><h2 id="Network-Topology"><a class="docs-heading-anchor" href="#Network-Topology">Network Topology</a><a id="Network-Topology-1"></a><a class="docs-heading-anchor-permalink" href="#Network-Topology" title="Permalink"></a></h2><p>All switches should periodically report their LLDP neighbors and port configuration. This information can be used to quickly identify common network issues, like MTU mismatch or the like. Ideally, there would be some graphical representation of the network topology containing only the most important information for a quick overview. It should contain all switches and machines as nodes and all connections as edges of a graph. Ports, VRFs, and maybe also IPs should be associated with a connection.</p><p>Apart from the topology graph, there should be a way to display more detailed information about both ports of a connection, like</p><ul><li>MTU</li><li>speed</li><li>IP</li><li>UP/DOWN status</li><li>VRF</li><li>VLAN</li><li>whether it participates in a BGP session</li></ul><h2 id="BGP-Announcements"><a class="docs-heading-anchor" href="#BGP-Announcements">BGP Announcements</a><a id="BGP-Announcements-1"></a><a class="docs-heading-anchor-permalink" href="#BGP-Announcements" title="Permalink"></a></h2><p>The metal-core should collect all routes it knows about and send them to the API along with a timestamp. Reported routes should be stored to a redis database along with the switch that reported them and the timestamp of the last time they were reported. An expiration threshold should be defined and all expired routes should be cleaned up periodically. Whenever new routes are reported they get merged into the existing ones by the strategy:</p><ul><li>when new, just add</li><li>when existing, update <code>last_announced</code> timestamp</li></ul><p>By querying the BGP announcements we can find out whether an allocated IP is still in use.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 18 August 2025 09:16">Monday 18 August 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
